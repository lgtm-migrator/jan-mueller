import{p as f,h as d,e as g}from"./chunks/jsxRuntime.module.d81ba1bb.js";import"./chunks/preact.module.f01f4b91.js";function w(e){return`eu.yeger.page-views.${e}`}const y={backendUrl:"https://page-views.up.railway.app/api/views",filter:()=>!0,throttle:864e5,trackPopState:!1};function s(e){return{...y,...e}}function h(){if(typeof window>"u"||typeof window.location>"u")return;const e=window.location,t=`${e.host}${e.pathname}`;return t.endsWith("/")?t.substring(0,t.length-1):t}async function a(e={},t){const n=t??h();if(!n)return;const{backendUrl:o,filter:i,throttle:r}=s(e);if(i(n)){if(r&&typeof localStorage<"u"){const c=Date.now(),u=localStorage.getItem(w(n));if(u!==null&&+u+r>c)return;localStorage.setItem(w(n),c.toString())}try{await fetch(`${o}/${n}`,{method:"POST"})}catch{}}}async function m(e={},t){const n=t??h();if(!n)return 0;const{backendUrl:o}=s(e);return+await(await fetch(`${o}/${n}`,{method:"GET"})).text()}let l=!1;function v(e={}){if(typeof window>"u"||typeof history>"u"||l)return;l=!0;const t=s(e);(()=>{const n=history.pushState;history.pushState=function(...o){const i=n.apply(this,o);return window.dispatchEvent(new Event("pushstate")),window.dispatchEvent(new Event("locationchange")),i},t.trackPopState&&window.addEventListener("popstate",()=>{window.dispatchEvent(new Event("locationchange"))})})(),window.addEventListener("locationchange",()=>{a(t)}),a(t)}const p={autoSubmitViews:v,getViews:m,submitView:a},$=()=>{const[e,t]=f(0);return d(()=>{p.submitView().then(()=>p.getViews()).then(t)},[]),g("span",{className:"text-lighter",children:[e," views"]})};export{$ as default};
