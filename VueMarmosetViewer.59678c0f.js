import{d,b as l,c,p as u,n as w,q as p,l as f}from"./chunks/runtime-core.esm-bundler.57e6cca6.js";import{_ as z}from"./chunks/_plugin-vue_export-helper.1e5d64a6.js";function V(e,t){let i;return()=>{i!==void 0&&clearTimeout(i),i=setTimeout(()=>e(),t)}}const n={width:800,height:600,autoStart:!1},h="marmoset-script",b="https://viewer.marmoset.co/main/marmoset.js";let o=!1,a=!1;function g(){return new Promise(e=>{var t;if(a){e();return}if(o){(t=document.getElementById(h))==null||t.addEventListener("load",()=>e());return}o=!0;const i=document.createElement("script");i.setAttribute("src",b),i.id=h,i.addEventListener("load",()=>{o=!1,a=!0,e()}),document.head.appendChild(i)})}const _=d({props:{src:{type:String,required:!0},width:{type:Number,default:n.width},height:{type:Number,default:n.height},responsive:{type:Boolean,default:!1},autoStart:{type:Boolean,default:!1}},emits:["load","resize","unload"],data(){return{viewer:void 0}},computed:{viewerHost(){return this.$refs.marmosetViewerHost},resizeObserver(){return new ResizeObserver(V(()=>this.onResize()))}},watch:{src(){this.reloadViewer()},width(){this.resize()},height(){this.resize()},responsive(e){e?this.resizeObserver.observe(this.viewerHost):(this.resizeObserver.unobserve(this.viewerHost),this.resize())},autoStart(e){var t;e&&((t=this.viewer)==null||t.loadScene())}},mounted(){g().then(()=>this.loadViewer())},beforeUnmount(){this.unloadViewer()},methods:{loadViewer(){this.viewer=new window.marmoset.WebViewer(this.width,this.height,this.src),this.viewerHost.appendChild(this.viewer.domRoot),this.viewer.onLoad=()=>this.$emit("load"),this.responsive&&this.resizeObserver.observe(this.viewerHost),this.autoStart&&this.viewer.loadScene()},unloadViewer(){this.viewer!==void 0&&(this.resizeObserver.unobserve(this.viewerHost),this.viewerHost.removeChild(this.viewer.domRoot),this.viewer.unload(),this.$emit("unload"))},reloadViewer(){this.unloadViewer(),this.loadViewer()},onResize(){var e;try{(e=this.viewer)==null||e.resize(this.viewerHost.clientWidth,this.viewerHost.clientHeight)}catch{}this.$emit("resize")},resize(){var e;if(!this.responsive){try{(e=this.viewer)==null||e.resize(this.width,this.height)}catch{}this.$emit("resize")}}}}),y=(e,t)=>{const i=e.__vccOpts||e;for(const[r,s]of t)i[r]=s;return i};function H(e,t,i,r,s,m){return l(),c("div",{ref:"marmosetViewerHost",class:u(["marmoset-viewer-host",{"marmoset-viewer-host__responsive":e.responsive}]),style:w({width:e.responsive?"100%":"fit-content",height:e.responsive?"calc(100% - 1px)":"fit-content"})},null,6)}const S=y(_,[["render",H]]),$=(()=>{const e=S;return e.install=t=>{t.component("MarmosetViewer",e)},e})(),O=d({components:{MarmosetViewer:$},props:{src:{type:String,required:!0},height:{type:Number,default:300}}}),C={class:"shadow-md rounded overflow-hidden relative isolate not-prose"};function B(e,t,i,r,s,m){const v=f("MarmosetViewer");return l(),c("div",C,[p(v,{src:e.src,responsive:"",height:e.height},null,8,["src","height"])])}const R=z(O,[["render",B]]);export{R as default};
