import{r as w}from"./chunks/index.2b9929e2.js";import{j as d}from"./chunks/jsx-runtime.98c74bd7.js";function p(e){return`eu.yeger.page-views.${e}`}const g={backendUrl:"https://page-views.up.railway.app/api/views",filter:()=>!0,throttle:864e5,trackPopState:!1};function s(e){return{...g,...e}}function f(){if(typeof window>"u"||typeof window.location>"u")return;const e=window.location,t=`${e.host}${e.pathname}`;return t.endsWith("/")?t.substring(0,t.length-1):t}async function a(e={},t){const n=t??f();if(!n)return;const{backendUrl:o,filter:i,throttle:r}=s(e);if(i(n)){if(r&&typeof localStorage<"u"){const c=Date.now(),u=localStorage.getItem(p(n));if(u!==null&&+u+r>c)return;localStorage.setItem(p(n),c.toString())}try{await fetch(`${o}/${n}`,{method:"POST"})}catch{}}}async function m(e={},t){const n=t??f();if(!n)return 0;const{backendUrl:o}=s(e);return+await(await fetch(`${o}/${n}`,{method:"GET"})).text()}let l=!1;function y(e={}){if(typeof window>"u"||typeof history>"u"||l)return;l=!0;const t=s(e);(()=>{const n=history.pushState;history.pushState=function(...o){const i=n.apply(this,o);return window.dispatchEvent(new Event("pushstate")),window.dispatchEvent(new Event("locationchange")),i},t.trackPopState&&window.addEventListener("popstate",()=>{window.dispatchEvent(new Event("locationchange"))})})(),window.addEventListener("locationchange",()=>{a(t)}),a(t)}const h={autoSubmitViews:y,getViews:m,submitView:a},E=()=>{const[e,t]=w.exports.useState(0);return w.exports.useEffect(()=>{h.submitView().then(()=>h.getViews()).then(t)},[]),d.exports.jsxs("span",{className:"text-lighter",children:[e," views"]})};export{E as default};
