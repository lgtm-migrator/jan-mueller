<!DOCTYPE html><html lang="en">
  <head class="max-w-full overflow-x-hidden">
    <!-- Global Metadata --><meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="mask-icon" href="/favicon.svg" color="#333">
<meta name="theme-color" content="#000000">
<meta name="generator" content="Astro v1.1.1">

<!-- Primary Meta Tags -->
<title>Next-level Heading Anchors with Astro and rehype – Jan Müller</title>
<meta name="title" content="Next-level Heading Anchors with Astro and rehype – Jan Müller">
<meta name="description" content="A guide on next-level heading anchors with Astro's Markdown pages and rehype.">
<link rel="canonical" href="https://jan-mueller.at/blog/next-level-heading-anchors/">

<!-- Open Graph / Facebook -->
<meta property="og:type" content="website">
<meta property="og:url" content="https://jan-mueller.at/blog/next-level-heading-anchors/">
<meta property="og:title" content="Next-level Heading Anchors with Astro and rehype – Jan Müller">
<meta property="og:description" content="A guide on next-level heading anchors with Astro's Markdown pages and rehype.">
<meta property="og:image" content="https://og-image-deryeger.vercel.app/**Next-level%20Heading%20Anchors%20with%20Astro%20and%20rehype**.png?theme=dark&#38;md=1&#38;fontSize=100px&#38;images=https%3A%2F%2Fjan-mueller.at%2Fog-image-light.svg&#38;images=https%3A%2F%2Fastro.build%2Fassets%2Fpress%2Ffull-logo-dark.svg&#38;images=https%3A%2F%2Ftailwindcss.com%2F_next%2Fstatic%2Fmedia%2Ftailwindcss-mark.79614a5f61617ba49a0891494521226b.svg">

<!-- Twitter -->
<meta property="twitter:creator" content="@DerYeger">
<meta property="twitter:card" content="summary_large_image">
<meta property="twitter:url" content="https://jan-mueller.at/blog/next-level-heading-anchors/">
<meta property="twitter:title" content="Next-level Heading Anchors with Astro and rehype – Jan Müller">
<meta property="twitter:description" content="A guide on next-level heading anchors with Astro's Markdown pages and rehype.">
<meta property="twitter:image" content="https://og-image-deryeger.vercel.app/**Next-level%20Heading%20Anchors%20with%20Astro%20and%20rehype**.png?theme=dark&#38;md=1&#38;fontSize=100px&#38;images=https%3A%2F%2Fjan-mueller.at%2Fog-image-light.svg&#38;images=https%3A%2F%2Fastro.build%2Fassets%2Fpress%2Ffull-logo-dark.svg&#38;images=https%3A%2F%2Ftailwindcss.com%2F_next%2Fstatic%2Fmedia%2Ftailwindcss-mark.79614a5f61617ba49a0891494521226b.svg">

<script>
  const theme = (() => {
    if (typeof localStorage !== 'undefined' && localStorage.getItem('theme')) {
      return localStorage.getItem('theme')
    }
    if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
      return 'dark'
    }
    return 'light'
  })()
  if (theme === 'light') {
    document.documentElement.classList.remove('dark')
  } else {
    document.documentElement.classList.add('dark')
  }
  window.localStorage.setItem('theme', theme)
</script>

  <link rel="stylesheet" href="/assets/28501d50.67a900e6.css" />
<link rel="stylesheet" href="/assets/1720694a.6284831a.css" /><script type="module" src="/page.3aa82516.js"></script></head>
  <body class="max-w-full overflow-x-hidden bg-white dark:bg-black text-black dark:text-white transition-colors">
    <header class="flex items-center justify-between p-4 pr-0 sticky top-0 surface-border glass z-10 border-b h-[48px]">
  <nav class="flex gap-2">
  <a href="/" rel="prefetch" class="inline-block border no-underline px-3 py-1 rounded text-sm hover:text-black hover:dark:text-white hover:border-neutral-400 hover:dark:border-neutral-600 border-transparent">
  Home
</a>
  <a href="/blog" rel="prefetch" class="inline-block border no-underline px-3 py-1 rounded text-sm hover:text-black hover:dark:text-white hover:border-neutral-400 hover:dark:border-neutral-600 border-transparent">
  Blog
</a>
</nav>
  <div>
    <style>astro-island,astro-slot{display:contents}</style><script>(self.Astro=self.Astro||{}).load=a=>{(async()=>await(await a())())()},window.dispatchEvent(new Event("astro:load"));var l;{const c={0:t=>t,1:t=>JSON.parse(t,o),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(JSON.parse(t,o)),5:t=>new Set(JSON.parse(t,o)),6:t=>BigInt(t),7:t=>new URL(t)},o=(t,i)=>{if(t===""||!Array.isArray(i))return i;const[e,n]=i;return e in c?c[e](n):void 0};customElements.get("astro-island")||customElements.define("astro-island",(l=class extends HTMLElement{constructor(){super(...arguments);this.hydrate=()=>{if(!this.hydrator||this.parentElement&&this.parentElement.closest("astro-island[ssr]"))return;const i=this.querySelectorAll("astro-slot"),e={},n=this.querySelectorAll("template[data-astro-template]");for(const s of n){const r=s.closest(this.tagName);!r||!r.isSameNode(this)||(e[s.getAttribute("data-astro-template")||"default"]=s.innerHTML,s.remove())}for(const s of i){const r=s.closest(this.tagName);!r||!r.isSameNode(this)||(e[s.getAttribute("name")||"default"]=s.innerHTML)}const a=this.hasAttribute("props")?JSON.parse(this.getAttribute("props"),o):{};this.hydrator(this)(this.Component,a,e,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),window.removeEventListener("astro:hydrate",this.hydrate),window.dispatchEvent(new CustomEvent("astro:hydrate"))}}connectedCallback(){!this.hasAttribute("await-children")||this.firstChild?this.childrenConnectedCallback():new MutationObserver((i,e)=>{e.disconnect(),this.childrenConnectedCallback()}).observe(this,{childList:!0})}async childrenConnectedCallback(){window.addEventListener("astro:hydrate",this.hydrate),await import(this.getAttribute("before-hydration-url")),this.start()}start(){const i=JSON.parse(this.getAttribute("opts")),e=this.getAttribute("client");if(Astro[e]===void 0){window.addEventListener(`astro:${e}`,()=>this.start(),{once:!0});return}Astro[e](async()=>{const n=this.getAttribute("renderer-url"),[a,{default:s}]=await Promise.all([import(this.getAttribute("component-url")),n?import(n):()=>()=>{}]),r=this.getAttribute("component-export")||"default";if(!r.includes("."))this.Component=a[r];else{this.Component=a;for(const d of r.split("."))this.Component=this.Component[d]}return this.hydrator=s,this.hydrate},i,this)}attributeChangedCallback(){this.hydrator&&this.hydrate()}},l.observedAttributes=["props"],l))}</script><astro-island uid="Z1zOUaJ" component-url="/ThemeToggle.4ef3e303.js" component-export="default" renderer-url="/client.f1d83173.js" props="{}" ssr="" client="load" before-hydration-url="data:text/javascript;charset=utf-8,//[no before-hydration script]" opts="{&quot;name&quot;:&quot;ThemeToggle&quot;,&quot;value&quot;:true}" await-children=""><template data-astro-template="dark"><svg viewBox="0 0 32 32" slot="dark" class="h-[24px] w-[24px]" astro-icon="carbon:moon"><path fill="currentColor" d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194 11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016 13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555 1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38 1.015 1.015 0 0 0 14.98 3z"/></svg></template><template data-astro-template="light"><svg viewBox="0 0 32 32" slot="light" class="h-[24px] w-[24px]" astro-icon="carbon:sun"><path fill="currentColor" d="M16 12.005a4 4 0 1 1-4 4 4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6 6 6 0 0 0-6-6zM5.394 6.813l1.414-1.415 3.506 3.506L8.9 10.318zM2 15.005h5v2H2zM5.394 25.197 8.9 21.691l1.414 1.415-3.506 3.505zM15 25.005h2v5h-2zM21.687 23.106l1.414-1.415 3.506 3.506-1.414 1.414zM25 15.005h5v2h-5zM21.687 8.904l3.506-3.506 1.414 1.415-3.506 3.505zM15 2.005h2v5h-2z"/></svg></template></astro-island>
  </div>
</header>
    <main class="bg-neutral-100 dark:bg-neutral-900 text-light">
  <article class="container mx-auto px-4 py-8 prose dark:prose-invert">
    <img class="w-full h-[200px] object-cover card border-0 astro-C563XDD6" alt="Next-level Heading Anchors with Astro and rehype" width="1300" height="400" src="/_image/assets/blog/space-horizon_1300x400.webp" loading="eager" decoding="async">


    <h1>Next-level Heading Anchors with Astro and rehype</h1>
    <div class="flex flex-wrap gap-1 mt-8 mb-4">
          <time>Aug 19, 2022</time>
          <span style="white-space: pre"> &middot; </span><div>
                Last updated on 
                <time>Aug 20, 2022</time>
              </div>
          <span style="white-space: pre"> &middot; </span>
          4 min read
        </div>
    <blockquote>A guide on next-level heading anchors with Astro&#39;s Markdown pages and rehype.</blockquote>
    <aside>
          <h2>Contents</h2>
          <ul>
            <li style="margin-left:0rem">
                <a href="#introduction">Introduction</a>
              </li><li style="margin-left:0rem">
                <a href="#configuring-rehype">Configuring rehype</a>
              </li><li style="margin-left:0rem">
                <a href="#issues-and-workarounds">Issues and Workarounds</a>
              </li><li style="margin-left:2rem">
                <a href="#anchor-icon-alignment">Anchor Icon Alignment</a>
              </li><li style="margin-left:2rem">
                <a href="#heading-offset">Heading Offset</a>
              </li><li style="margin-left:0rem">
                <a href="#conclusion">Conclusion</a>
              </li><li style="margin-left:0rem">
                <a href="#changelog">Changelog</a>
              </li>
          </ul>
        </aside>
    <h2 id="introduction">Introduction<a aria-hidden="true" tabIndex="-1" href="#introduction"><span class="anchor-icon" aria-hidden="true"><svg width="16" height="16" version="1.1" viewBox="0 0 16 16" xlmns="http://www.w3.org/2000/svg"><path fillRule="evenodd" fill="currentcolor" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></span><span class="sr-only" is:raw="true">Section titled Introduction</span></a></h2>
<p><a href="https://astro.build" target="_blank" rel="noreferrer">Astro</a> enables powerful customization of Markdown pages by using <a href="https://github.com/rehypejs/rehype" target="_blank" rel="noreferrer">rehype</a> plugins.
In this guide, I’ll teach you how to automatically create next-level anchor links for headings with Astro and <a href="https://tailwindcss.com" target="_blank" rel="noreferrer">Tailwind CSS</a>.
In the following sections, I’ll assume basic knowledge about the used technologies.</p>
<p>If you have already worked with heading anchors on a site that has a sticky header (like this one), you will know that navigating to an anchor by its slug (e.g., <code>#introduction</code>) will result in the heading being obstructed by the header.
By following the guide below, you will end up with anchor links that avoid this issue.</p>
<h2 id="configuring-rehype">Configuring rehype<a aria-hidden="true" tabIndex="-1" href="#configuring-rehype"><span class="anchor-icon" aria-hidden="true"><svg width="16" height="16" version="1.1" viewBox="0 0 16 16" xlmns="http://www.w3.org/2000/svg"><path fillRule="evenodd" fill="currentcolor" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></span><span class="sr-only" is:raw="true">Section titled Configuring%20rehype</span></a></h2>
<p>To get started, add the <code>@astrojs/mdx</code> and <code>@astrojs/tailwind</code> integrations to your project.
We will also need the following packages:</p>
<pre class="astro-code" style="background-color:#272822;overflow-x:auto"><code><span class="line"><span style="color:#F8F8F2">yarn add -D rehype-autolink-headings hastscript hast-util-to-string</span></span></code></pre>
<p>Then, we will update Astro’s config <code>astro.config.mjs</code> to automatically generate the links.
I have taken quite a bit of this configuration from the <a href="https://github.com/withastro/docs/blob/main/astro.config.ts" target="_blank" rel="noreferrer">official Astro doc’s config</a>, including their <code>AnchorLinkIcon</code> and <code>createSROnlyLabel</code>.
However, I couldn’t get the rehype plugins working unless I configured them in the config of the <code>@astrojs/mdx</code> integration.</p>
<pre class="astro-code" style="background-color:#272822;overflow-x:auto"><code><span class="line"><span style="color:#F92672">import</span><span style="color:#F8F8F2"> mdx </span><span style="color:#F92672">from</span><span style="color:#F8F8F2"> </span><span style="color:#E6DB74">&#39;@astrojs/mdx&#39;</span></span>
<span class="line"><span style="color:#F92672">import</span><span style="color:#F8F8F2"> tailwind </span><span style="color:#F92672">from</span><span style="color:#F8F8F2"> </span><span style="color:#E6DB74">&#39;@astrojs/tailwind&#39;</span></span>
<span class="line"><span style="color:#F92672">import</span><span style="color:#F8F8F2"> { defineConfig } </span><span style="color:#F92672">from</span><span style="color:#F8F8F2"> </span><span style="color:#E6DB74">&#39;astro/config&#39;</span></span>
<span class="line"><span style="color:#F92672">import</span><span style="color:#F8F8F2"> { toString } </span><span style="color:#F92672">from</span><span style="color:#F8F8F2"> </span><span style="color:#E6DB74">&#39;hast-util-to-string&#39;</span></span>
<span class="line"><span style="color:#F92672">import</span><span style="color:#F8F8F2"> { h } </span><span style="color:#F92672">from</span><span style="color:#F8F8F2"> </span><span style="color:#E6DB74">&#39;hastscript&#39;</span></span>
<span class="line"><span style="color:#F92672">import</span><span style="color:#F8F8F2"> autolinkHeadings </span><span style="color:#F92672">from</span><span style="color:#F8F8F2"> </span><span style="color:#E6DB74">&#39;rehype-autolink-headings&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">// The following configuration for rehype-autolink-headings was taken from https://github.com/withastro/docs/blob/main/astro.config.ts</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">const</span><span style="color:#F8F8F2"> AnchorLinkIcon </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> </span><span style="color:#A6E22E">h</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#F8F8F2">  </span><span style="color:#E6DB74">&#39;svg&#39;</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">  {</span></span>
<span class="line"><span style="color:#F8F8F2">    width: </span><span style="color:#AE81FF">16</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">    height: </span><span style="color:#AE81FF">16</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">    version: </span><span style="color:#AE81FF">1.1</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">    viewBox: </span><span style="color:#E6DB74">&#39;0 0 16 16&#39;</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">    xlmns: </span><span style="color:#E6DB74">&#39;http://www.w3.org/2000/svg&#39;</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">  },</span></span>
<span class="line"><span style="color:#F8F8F2">  </span><span style="color:#A6E22E">h</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">&#39;path&#39;</span><span style="color:#F8F8F2">, {</span></span>
<span class="line"><span style="color:#F8F8F2">    fillRule: </span><span style="color:#E6DB74">&#39;evenodd&#39;</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">    fill: </span><span style="color:#E6DB74">&#39;currentcolor&#39;</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">    d: </span><span style="color:#E6DB74">&#39;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&#39;</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">  })</span></span>
<span class="line"><span style="color:#F8F8F2">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">const</span><span style="color:#F8F8F2"> </span><span style="color:#A6E22E">createSROnlyLabel</span><span style="color:#F8F8F2"> </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> (</span><span style="color:#FD971F;font-style:italic">text</span><span style="color:#F8F8F2">) </span><span style="color:#66D9EF;font-style:italic">=&gt;</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">  </span><span style="color:#66D9EF;font-style:italic">const</span><span style="color:#F8F8F2"> node </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> </span><span style="color:#A6E22E">h</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">&#39;span.sr-only&#39;</span><span style="color:#F8F8F2">, </span><span style="color:#E6DB74">`Section titled </span><span style="color:#F92672">${</span><span style="color:#66D9EF">escape</span><span style="color:#F8F8F2">(text)</span><span style="color:#F92672">}</span><span style="color:#E6DB74">`</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">  node.properties[</span><span style="color:#E6DB74">&#39;is:raw&#39;</span><span style="color:#F8F8F2">] </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> </span><span style="color:#AE81FF">true</span></span>
<span class="line"><span style="color:#F8F8F2">  </span><span style="color:#F92672">return</span><span style="color:#F8F8F2"> node</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">export</span><span style="color:#F8F8F2"> </span><span style="color:#F92672">default</span><span style="color:#F8F8F2"> </span><span style="color:#A6E22E">defineConfig</span><span style="color:#F8F8F2">({</span></span>
<span class="line"><span style="color:#F8F8F2">  integrations: [</span></span>
<span class="line"><span style="color:#F8F8F2">    </span><span style="color:#A6E22E">mdx</span><span style="color:#F8F8F2">({</span></span>
<span class="line"><span style="color:#F8F8F2">      rehypePlugins: {</span></span>
<span class="line"><span style="color:#F8F8F2">        extends: [</span></span>
<span class="line"><span style="color:#F8F8F2">          [</span></span>
<span class="line"><span style="color:#F8F8F2">            autolinkHeadings,</span></span>
<span class="line"><span style="color:#F8F8F2">            {</span></span>
<span class="line"><span style="color:#F8F8F2">              behavior: </span><span style="color:#E6DB74">&#39;append&#39;</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">              </span><span style="color:#A6E22E">group</span><span style="color:#F8F8F2">: ({ </span><span style="color:#FD971F;font-style:italic">tagName</span><span style="color:#F8F8F2"> }) </span><span style="color:#66D9EF;font-style:italic">=&gt;</span></span>
<span class="line"><span style="color:#F8F8F2">                </span><span style="color:#A6E22E">h</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">`div.heading-wrapper.level-</span><span style="color:#F92672">${</span><span style="color:#F8F8F2">tagName</span><span style="color:#F92672">}</span><span style="color:#E6DB74">`</span><span style="color:#F8F8F2">, {</span></span>
<span class="line"><span style="color:#F8F8F2">                  tabIndex: </span><span style="color:#F92672">-</span><span style="color:#AE81FF">1</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">                }),</span></span>
<span class="line"><span style="color:#F8F8F2">              </span><span style="color:#A6E22E">content</span><span style="color:#F8F8F2">: (</span><span style="color:#FD971F;font-style:italic">heading</span><span style="color:#F8F8F2">) </span><span style="color:#66D9EF;font-style:italic">=&gt;</span><span style="color:#F8F8F2"> [</span></span>
<span class="line"><span style="color:#F8F8F2">                </span><span style="color:#A6E22E">h</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#F8F8F2">                  </span><span style="color:#E6DB74">`span.anchor-icon`</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">                  {</span></span>
<span class="line"><span style="color:#F8F8F2">                    ariaHidden: </span><span style="color:#E6DB74">&#39;true&#39;</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">                  },</span></span>
<span class="line"><span style="color:#F8F8F2">                  AnchorLinkIcon</span></span>
<span class="line"><span style="color:#F8F8F2">                ),</span></span>
<span class="line"><span style="color:#F8F8F2">                </span><span style="color:#A6E22E">createSROnlyLabel</span><span style="color:#F8F8F2">(</span><span style="color:#A6E22E">toString</span><span style="color:#F8F8F2">(heading)),</span></span>
<span class="line"><span style="color:#F8F8F2">              ],</span></span>
<span class="line"><span style="color:#F8F8F2">            },</span></span>
<span class="line"><span style="color:#F8F8F2">          ],</span></span>
<span class="line"><span style="color:#F8F8F2">        ],</span></span>
<span class="line"><span style="color:#F8F8F2">      },</span></span>
<span class="line"><span style="color:#F8F8F2">    }),</span></span>
<span class="line"><span style="color:#F8F8F2">    </span><span style="color:#A6E22E">tailwind</span><span style="color:#F8F8F2">(),</span></span>
<span class="line"><span style="color:#F8F8F2">    </span><span style="color:#88846F">// ...remaining integrations</span></span>
<span class="line"><span style="color:#F8F8F2">  ],</span></span>
<span class="line"><span style="color:#F8F8F2">  </span><span style="color:#88846F">// ...remaining config</span></span>
<span class="line"><span style="color:#F8F8F2">})</span></span></code></pre>
<p>Now all of your headings in <code>.mdx</code> files should have anchors and IDs!
The labels for screen readers are already hidden by Tailwind’s styles for the <code>.sr-only</code> class we applied.</p>
<p>Unfortunately, icons will not be aligned with their headings, and navigating to a heading via its slug will result in it being obstructed by the header.
We will fix that in the next section!</p>
<h2 id="issues-and-workarounds">Issues and Workarounds<a aria-hidden="true" tabIndex="-1" href="#issues-and-workarounds"><span class="anchor-icon" aria-hidden="true"><svg width="16" height="16" version="1.1" viewBox="0 0 16 16" xlmns="http://www.w3.org/2000/svg"><path fillRule="evenodd" fill="currentcolor" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></span><span class="sr-only" is:raw="true">Section titled Issues%20and%20Workarounds</span></a></h2>
<p>Here’s what we need to achieve:</p>
<ol>
<li>Align the anchor icon with the heading’s text</li>
<li>Prevent a sticky header from obstructing headings when navigating by slugs</li>
</ol>
<h3 id="anchor-icon-alignment">Anchor Icon Alignment<a aria-hidden="true" tabIndex="-1" href="#anchor-icon-alignment"><span class="anchor-icon" aria-hidden="true"><svg width="16" height="16" version="1.1" viewBox="0 0 16 16" xlmns="http://www.w3.org/2000/svg"><path fillRule="evenodd" fill="currentcolor" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></span><span class="sr-only" is:raw="true">Section titled Anchor%20Icon%20Alignment</span></a></h3>
<p>Fixing the alignment of anchor icons is trivial using Flexbox.
An intuitive solution for the problem are the following Tailwind utilities:</p>
<pre class="astro-code" style="background-color:#272822;overflow-x:auto"><code><span class="line"><span style="color:#F92672">@layer</span><span style="color:#F8F8F2"> components {</span></span>
<span class="line"><span style="color:#F8F8F2">  </span><span style="color:#F92672">*</span><span style="color:#F8F8F2">:is(</span><span style="color:#F92672">h1</span><span style="color:#F8F8F2">, </span><span style="color:#F92672">h2</span><span style="color:#F8F8F2">, </span><span style="color:#F92672">h3</span><span style="color:#F8F8F2">, </span><span style="color:#F92672">h4</span><span style="color:#F8F8F2">, </span><span style="color:#F92672">h5</span><span style="color:#F8F8F2">, </span><span style="color:#F92672">h6</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#F8F8F2">    @apply </span><span style="color:#66D9EF;font-style:italic">flex</span><span style="color:#F8F8F2"> items-center gap-2;</span></span>
<span class="line"><span style="color:#F8F8F2">  }</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<h3 id="heading-offset">Heading Offset<a aria-hidden="true" tabIndex="-1" href="#heading-offset"><span class="anchor-icon" aria-hidden="true"><svg width="16" height="16" version="1.1" viewBox="0 0 16 16" xlmns="http://www.w3.org/2000/svg"><path fillRule="evenodd" fill="currentcolor" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></span><span class="sr-only" is:raw="true">Section titled Heading%20Offset</span></a></h3>
<p>Next, we will prevent a sticky header from overlaying headings by using the <code>scroll-margin-top</code> property.
In addition to the height of the header, you may also consider adding any <code>padding</code> of the Markdown’s container element to the scroll-margin.
In the case of my blog, this is <code>48px</code> (height of the header) + <code>32px</code> (padding of <code>main</code>) = <code>80px</code>.
This translates to Tailwind’s <code>scroll-mt-20</code> utility.</p>
<pre class="astro-code" style="background-color:#272822;overflow-x:auto"><code><span class="line"><span style="color:#F92672">@layer</span><span style="color:#F8F8F2"> components {</span></span>
<span class="line"><span style="color:#F8F8F2">  </span><span style="color:#F92672">*</span><span style="color:#F8F8F2">:is(</span><span style="color:#F92672">h1</span><span style="color:#F8F8F2">, </span><span style="color:#F92672">h2</span><span style="color:#F8F8F2">, </span><span style="color:#F92672">h3</span><span style="color:#F8F8F2">, </span><span style="color:#F92672">h4</span><span style="color:#F8F8F2">, </span><span style="color:#F92672">h5</span><span style="color:#F8F8F2">, </span><span style="color:#F92672">h6</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#F8F8F2">    @apply scroll-mt-20;</span></span>
<span class="line"><span style="color:#F8F8F2">  }</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<h2 id="conclusion">Conclusion<a aria-hidden="true" tabIndex="-1" href="#conclusion"><span class="anchor-icon" aria-hidden="true"><svg width="16" height="16" version="1.1" viewBox="0 0 16 16" xlmns="http://www.w3.org/2000/svg"><path fillRule="evenodd" fill="currentcolor" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></span><span class="sr-only" is:raw="true">Section titled Conclusion</span></a></h2>
<p>Setting up automatic anchor generation is not that difficult, thanks to <code>rehype-autolink-headers</code>.
While they require some styling to work well with sticky headers, Tailwind CSS reduces this to a few lines of code.</p>
<p>We ended up with the following CSS to create accessible anchors and headings that won’t be obstructed by headers.</p>
<pre class="astro-code" style="background-color:#272822;overflow-x:auto"><code><span class="line"><span style="color:#F92672">@layer</span><span style="color:#F8F8F2"> components {</span></span>
<span class="line"><span style="color:#F8F8F2">  </span><span style="color:#F92672">*</span><span style="color:#F8F8F2">:is(</span><span style="color:#F92672">h1</span><span style="color:#F8F8F2">, </span><span style="color:#F92672">h2</span><span style="color:#F8F8F2">, </span><span style="color:#F92672">h3</span><span style="color:#F8F8F2">, </span><span style="color:#F92672">h4</span><span style="color:#F8F8F2">, </span><span style="color:#F92672">h5</span><span style="color:#F8F8F2">, </span><span style="color:#F92672">h6</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#F8F8F2">    @apply </span><span style="color:#66D9EF;font-style:italic">flex</span><span style="color:#F8F8F2"> items-center gap-2 scroll-mt-20;</span></span>
<span class="line"><span style="color:#F8F8F2">  }</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<blockquote>
<p>You may need to increase specificity of the selectors depending on your markup, e.g., <code>article *:is(h1, h2, h3, h4, h5, h6)</code>.</p>
</blockquote>
<h2 id="changelog">Changelog<a aria-hidden="true" tabIndex="-1" href="#changelog"><span class="anchor-icon" aria-hidden="true"><svg width="16" height="16" version="1.1" viewBox="0 0 16 16" xlmns="http://www.w3.org/2000/svg"><path fillRule="evenodd" fill="currentcolor" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></span><span class="sr-only" is:raw="true">Section titled Changelog</span></a></h2>
<ul>
<li><strong>20th August 2022</strong>: A reader informed me that my previous solution for the heading offset could be simplified by using the <code>scroll-margin-top</code> property described above.
I updated this guide accordingly.</li>
</ul>
  </article>
</main>
    <footer class="surface text-sm border-t shadow-none px-2 py-8 children:px-2 flex flex-row gap-0 items-start justify-center children:flex children:flex-col [&>*>*:first-child]:mb-4 [&>*>*:not(:first-child)]:py-2 [&>*>*:not(:first-child)]:w-fit children:w-1/3 children:max-w-[10rem]">
  <div>
    <span>Legal</span>
    <a href="/impressum" rel="prefetch" lang="de">Impressum</a>
    <a href="/datenschutzerklaerung" rel="prefetch" style="hyphens: auto; word-wrap: anywhere;" lang="de">
      Datenschutzerklärung
    </a>
    <a href="/legal-notice" rel="prefetch">Legal Notice</a>
    <span class="text-lighter">
      2022 &copy; Jan M&uuml;ller
    </span>
  </div>
  <div>
    <span>Resources</span>
    <a href="/rss.xml"> RSS Feed</a>
    <a href="https://github.com/DerYeger/jan-mueller" rel="noreferrer" target="_blank">
      Source
      <svg viewBox="0 0 24 24" class="ml-1 mb-[0.125em] h-[1em] w-[1em] inline" astro-icon="ic:round-open-in-new"><path fill="currentColor" d="M18 19H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h5c.55 0 1-.45 1-1s-.45-1-1-1H5a2 2 0 0 0-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-6c0-.55-.45-1-1-1s-1 .45-1 1v5c0 .55-.45 1-1 1zM14 4c0 .55.45 1 1 1h2.59l-9.13 9.13a.996.996 0 1 0 1.41 1.41L19 6.41V9c0 .55.45 1 1 1s1-.45 1-1V4c0-.55-.45-1-1-1h-5c-.55 0-1 .45-1 1z"/></svg>
    </a>
    <script>(self.Astro=self.Astro||{}).idle=t=>{const e=async()=>{await(await t())()};"requestIdleCallback"in window?window.requestIdleCallback(e):setTimeout(e,200)},window.dispatchEvent(new Event("astro:idle"));</script><astro-island uid="yd0cf" component-url="/ViewCounter.c8bd0616.js" component-export="default" renderer-url="/client.f1d83173.js" props="{}" ssr="" client="idle" before-hydration-url="data:text/javascript;charset=utf-8,//[no before-hydration script]" opts="{&quot;name&quot;:&quot;ViewCounter&quot;,&quot;value&quot;:true}" await-children=""><span class="text-lighter">0 views</span></astro-island>
  </div>
  <div>
    <span>Contact</span>
    <a href="https://github.com/DerYeger" rel="noreferrer" target="_blank">
          GitHub
          <svg viewBox="0 0 24 24" class="ml-1 mb-[0.125em] h-[1em] w-[1em] inline" astro-icon="ic:round-open-in-new"><path fill="currentColor" d="M18 19H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h5c.55 0 1-.45 1-1s-.45-1-1-1H5a2 2 0 0 0-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-6c0-.55-.45-1-1-1s-1 .45-1 1v5c0 .55-.45 1-1 1zM14 4c0 .55.45 1 1 1h2.59l-9.13 9.13a.996.996 0 1 0 1.41 1.41L19 6.41V9c0 .55.45 1 1 1s1-.45 1-1V4c0-.55-.45-1-1-1h-5c-.55 0-1 .45-1 1z"/></svg>
        </a><a href="https://www.linkedin.com/in/jan-müller-644144249/" rel="noreferrer" target="_blank">
          LinkedIn
          <svg viewBox="0 0 24 24" class="ml-1 mb-[0.125em] h-[1em] w-[1em] inline" astro-icon="ic:round-open-in-new"><path fill="currentColor" d="M18 19H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h5c.55 0 1-.45 1-1s-.45-1-1-1H5a2 2 0 0 0-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-6c0-.55-.45-1-1-1s-1 .45-1 1v5c0 .55-.45 1-1 1zM14 4c0 .55.45 1 1 1h2.59l-9.13 9.13a.996.996 0 1 0 1.41 1.41L19 6.41V9c0 .55.45 1 1 1s1-.45 1-1V4c0-.55-.45-1-1-1h-5c-.55 0-1 .45-1 1z"/></svg>
        </a><a href="https://www.xing.com/profile/Jan_Mueller1092/cv" rel="noreferrer" target="_blank">
          XING
          <svg viewBox="0 0 24 24" class="ml-1 mb-[0.125em] h-[1em] w-[1em] inline" astro-icon="ic:round-open-in-new"><path fill="currentColor" d="M18 19H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h5c.55 0 1-.45 1-1s-.45-1-1-1H5a2 2 0 0 0-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-6c0-.55-.45-1-1-1s-1 .45-1 1v5c0 .55-.45 1-1 1zM14 4c0 .55.45 1 1 1h2.59l-9.13 9.13a.996.996 0 1 0 1.41 1.41L19 6.41V9c0 .55.45 1 1 1s1-.45 1-1V4c0-.55-.45-1-1-1h-5c-.55 0-1 .45-1 1z"/></svg>
        </a><a href="https://twitter.com/DerYeger" rel="noreferrer" target="_blank">
          Twitter
          <svg viewBox="0 0 24 24" class="ml-1 mb-[0.125em] h-[1em] w-[1em] inline" astro-icon="ic:round-open-in-new"><path fill="currentColor" d="M18 19H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h5c.55 0 1-.45 1-1s-.45-1-1-1H5a2 2 0 0 0-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-6c0-.55-.45-1-1-1s-1 .45-1 1v5c0 .55-.45 1-1 1zM14 4c0 .55.45 1 1 1h2.59l-9.13 9.13a.996.996 0 1 0 1.41 1.41L19 6.41V9c0 .55.45 1 1 1s1-.45 1-1V4c0-.55-.45-1-1-1h-5c-.55 0-1 .45-1 1z"/></svg>
        </a>
    <a href="mailto:mail@jan-mueller.at" title="Mail">Mail</a>
  </div>
</footer>
  </body></html>